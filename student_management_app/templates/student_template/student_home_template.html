{% extends 'student_template/base_template.html' %}

{% block page_title %}
    @{{user}}     

{% endblock page_title %}

{% block main_content %}

{% load static %}

<section class="content">
        <div class="container-fluid">

            {% comment %} Boxes Section Starts {% endcomment %}
            <div class="row">
                <div  class="col-lg-3 col-6">
                    <!-- small box -->
                    <div style="background: linear-gradient(-45deg,rgba(147,26,222,0.83) 0%,rgba(28,206,234,0.82) 100%);" class="small-box bg-info">
                    <div style="background: linear-gradient(-45deg,rgba(147,26,222,0.83) 0%,rgba(28,206,234,0.82) 100%);" class="inner">
                        <h3>{{ total_attendance }}</h3>

                        <p>Total Attendance</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-stats-bars"></i>
                    </div>
                    <a href="#
                    " class="small-box-footer"> <i class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <!-- ./col -->
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div style="background: linear-gradient(-45deg,rgba(147,26,222,0.83) 0%,rgba(28,206,234,0.82) 100%);" class="small-box bg-info">
                        <div style="background: linear-gradient(-45deg,rgba(147,26,222,0.83) 0%,rgba(28,206,234,0.82) 100%);" class="inner">
                        <h3>{{ attendance_absent }}</h3>

                        <p>Absent</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-stats-bars"></i>
                    </div>
                    <a href="#" class="small-box-footer"> <i class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>


                <!-- ./col -->
                <div  class="col-lg-3 col-6">
                    <!-- small box -->
                    <div style="background: linear-gradient(-45deg,rgba(147,26,222,0.83) 0%,rgba(28,206,234,0.82) 100%);" class="small-box bg-info">
                        <div style="background: linear-gradient(-45deg,rgba(147,26,222,0.83) 0%,rgba(28,206,234,0.82) 100%);" class="inner">
                        <h3>{{ attendance_present }}</h3>

                        <p>Present</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-stats-bars"></i>
                    </div>
                    <a href="#" class="small-box-footer"> <i class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <!-- ./col -->
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div style="background: linear-gradient(-45deg,rgba(147,26,222,0.83) 0%,rgba(28,206,234,0.82) 100%);" class="small-box bg-info">
                    <div style="background: linear-gradient(-45deg,rgba(147,26,222,0.83) 0%,rgba(28,206,234,0.82) 100%);" class="inner">
                        <h3>{{ total_subjects }}</h3>

                        <p>Total Subjects</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-pie-graph"></i>
                    </div>
                    <a href="{% url 'student_show_more_student_detile' %}" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <!-- ./col -->

                                <!-- ./col -->
  
                </div>

                
                                       
           

           
        </div>

            <div class="row">
                <div class="col-lg-6">
                    <!-- PIE CHART -->
                    <div class="card card-danger">
                    <div class="card-header">
                        <h3 class="card-title">Total Attendance Chart</h3>

                        <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-times"></i></button>
                        </div>
                    </div>
                    <div class="card-body">
                        <canvas id="pieChart" style="min-height: 300px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
                    </div>
                    <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                </div>

                <div class="col-lg-6">
                    <!-- BAR CHART -->
                    <div class="card card-success">
                    <div class="card-header">
                        <h3 class="card-title">Attendance Statistics by Subjects</h3>

                        <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-times"></i></button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="chart">
                        <canvas id="myChart_bar" style="min-height: 350px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
                        </div>
                    </div>
                    <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                </div>
            </div>


            <div class="row">


                <div class="col-lg-6">
                    <!-- BAR CHART -->
                    <div class="card card-success">
                    <div class="card-header">
                        <h3 class="card-title">Student rating To each Subject</h3>

                        <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-times"></i></button>
                        </div>
                    </div>
                    <div class="card-body">
                        <style>
                            .star #stars{
                                font-size:300%;color:black;
                            }
                            .star:hover #stars{
                                color:rgb(241, 179, 72)

                            }
                            .star.active #stars{
                                color:rgb(241, 179, 72) !important

                            }

                        </style>
                       
                        <div class="chart">
                            <style>
                                .checked {
                             color: orange;
                           }
                           
                           .my-btn{
                               background-color: inherit !important; 
                               border: 0  !important;
                           }
                           .show {
                               background-color: inherit !important; 
                               border: 0  !important;
                           }
                            </style>
                            


  
                            
                            <div class="new_row">
                                {% for subj, star in stars  %}
                                <div class="row">

                                <button type="button" style="margin: 10px; width: 150px;" class="btn btn-info">{{subj}}</button> 


                                    <div class="col text-center">
                                        <h5 style="display: none;" id="score">{{star.Degree}}</h5>
                                        <form class="rate-form" action="" method="POST" id="{{star.id}}">
                                            {% csrf_token %}
                                            <span  class="fa fa-star show " id="first1"></span>
                                            <span  class="fa fa-star show   " id="second2"></span>
                                            <span  class="fa fa-star show  " id="third3"></span>
                                            <span  class="fa fa-star show  " id="fourth4"></span>
                                            <span  class="fa fa-star show " id="fifth5"></span>
                                         
                                        </form>
                                        
                                   </div>

                                </div>

                              
                               
                                    
 
                                {% endfor %}
                            </div>

                            
                        </div>
                    </div>
                    <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                </div>
            </div>

        </div><!-- /.container-fluid -->
      </section>

  {% endblock main_content %}

  {% block custom_js %}
  <script>
    const forms = document.querySelectorAll('.rate-form')
    const score = document.querySelectorAll('#score')

    console.log(forms)
    for (let i = 0; i < forms.length; i++) {

         console.log(forms[i]);
         let childern = forms[i].children
         console.log( score[i].innerHTML);


         for (let j = 0; j < childern.length; j++) {
            
            if (j <= Number(score[i].innerHTML)) {
                childern[j].classList.add('checked')

    
        }else{
            childern[j].classList.remove('checked')
        }
          
             
         }
        
    }



  </script>
  <script>
      
      function stars(e){



        
          let myval = null
          let stars = document.querySelectorAll('.star');
          let rate_num = document.getElementById('rate');

          for (let i = 0; i < stars.length; i++) {
            stars[i].classList.remove('active');
              const element = stars[i];

            }

          for (let j = 0; j <= e; j++) {
            stars[j].classList.add('active');
            myval = j+1
             const element = stars[j];
             
        
              
          }
          rate_num.innerHTML = myval

      }

      stars()
  </script>
    <script>
       $(document).ready(function(){
           //Code for Pie Chart
            var pieData        = {
            labels: [
                'ABSENT', 
                'PRESENT', 
            ],
            datasets: [
                {
                data: [{{ attendance_absent }}, {{ attendance_present }}],
                backgroundColor : ['#f56954', '#00a65a'],
                }
            ]
            }
           //Code for Pie Chart
            var pieChartCanvas = $('#pieChart').get(0).getContext('2d')
            var pieData        = pieData;
            var pieOptions     = {
            maintainAspectRatio : false,
            responsive : true,
            }
            //Create pie or douhnut chart
            // You can switch between pie and douhnut using the method below.
            var pieChart = new Chart(pieChartCanvas, {
                type: 'doughnut',
                            data: pieData,
            options: pieOptions      
            })

            //Code for Bar Chart
            var subjects = {{ subject_name|safe }}
            var data_present = {{ data_present }}
            var data_absent = {{ data_absent }}

            //Dataset for Bar Chart
            var areaChartData = {
            labels  : [1, 5],
            datasets: [
                {
                label               : 'Present in Class',
                backgroundColor: [
                'rgba(255, 99, 132,1)',
                'rgba(54, 162, 235,1)',
                'rgba(255, 206, 86,1)',
                'rgba(75, 192, 192,1)',
                'rgba(153, 102, 255,1)',
                'rgba(255, 159, 64,1)'
            ],
             borderColor: [
                  'rgba(255, 99, 132, 1)',
                  'rgba(54, 162, 235, 1)',
                  'rgba(255, 206, 86, 1)',
                  'rgba(75, 192, 192, 1)',
                  'rgba(153, 102, 255, 1)',
                  'rgba(255, 159, 64, 1)'
              ],
               
                },
            ]
            }


         


       });


const ctx2 = document.getElementById('myChart_dbar').getContext('2d');
let subject_all = {{subject_name | safe}}
let data = {{all_subject_attendance}}
const myChart_bar = new Chart(ctx2, {
    type: 'bar',
        data: {
          labels: subject_all,
          datasets: [{
              label: '',
  
              data: data,
              backgroundColor: [
                  'rgba(255, 99, 132,1)',
                  'rgba(54, 162, 235,1)',
                  'rgba(255, 206, 86,1)',
                  'rgba(75, 192, 192,1)',
                  'rgba(153, 102, 255,1)',
                  'rgba(255, 159, 64,1)'
              ],
              borderColor: [
                  'rgba(255, 99, 132, 1)',
                  'rgba(54, 162, 235, 1)',
                  'rgba(255, 206, 86, 1)',
                  'rgba(75, 192, 192, 1)',
                  'rgba(153, 102, 255, 1)',
                  'rgba(255, 159, 64, 1)'
              ],
              borderWidth: 1,
          }],
      },
      options: {
      
            responsive:true
  
            
          
      }
  });
    </script>



<script>



    let subject_alls = {{subject_name | safe}}
    let data_all = {{all_subject_attendance}}
        const ctx3 = document.getElementById('myChart_bar').getContext('2d');
        const myChart2 = new Chart(ctx3, {
            type: 'polarArea',  
                                         data: {
                labels: subject_alls,
                datasets: [{
                    label: '# of Votes',
                    data: data_all,
                    backgroundColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive:true,
                
            }
        });
     </script>
    
     <script>
        var cancel = document.getElementsByTagName('footer')
        var cancel1 = document.getElementsByTagName('strong')
        cancel.innerHTML = '';
        cancel.removeChild(cancel1);
        console.log(cancel, 'test');
      </script>
         
        
         
  {% endblock custom_js %}